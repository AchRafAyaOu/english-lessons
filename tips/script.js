 tips = [
  { id: 11, type: "قاعدة نحوية", icon: "fa-book", title: "استخدام 'much'", text: "استخدم 'much' مع الأسماء غير المعدودة، غالبًا في النفي والأسئلة.", example: "We don't have much time.", exampleAr: "ليس لدينا الكثير من الوقت.", link: "#", quiz: { question: "متى تُستخدم 'much'؟", options: ["مع الأسماء المعدودة", "مع الأسماء غير المعدودة في النفي والأسئلة", "في الجمل الإيجابية فقط"], correct: 1 } },
  { id: 12, type: "قاعدة نحوية", icon: "fa-book", title: "Few مقابل 'A few'", text: "'Few' تعني قلة مزعجة؛ 'a few' تعني عدد قليل لكنه كافٍ.", example: "I have a few friends. / I have few friends.", exampleAr: "لدي عدد قليل من الأصدقاء. / لدي القليل من الأصدقاء.", link: "#", quiz: { question: "ما الفرق بين 'few' و'a few'؟", options: ["'Few' إيجابية، 'a few' سلبية", "'Few' قلة غير كافية، 'a few' قليل لكنه كافٍ", "لا فرق"], correct: 1 } },
  { id: 13, type: "قاعدة نحوية", icon: "fa-book", title: "Little مقابل 'A little'", text: "'Little' تعني قليل غير كافٍ لغير المعدود؛ 'a little' تعني قليل لكنه كافٍ.", example: "I have a little money. / I have little money.", exampleAr: "لدي القليل من المال. / لدي قليل من المال.", link: "#", quiz: { question: "ما معنى 'a little'؟", options: ["قليل غير كافٍ", "قليل لكنه كافٍ", "كثير"], correct: 1 } },
  { id: 14, type: "قاعدة نحوية", icon: "fa-book-open", title: "أدوات التعريف: a/an/the", text: "'A/an' للمفرد غير المحدد؛ 'the' للمعروف أو الفريد.", example: "I saw a dog. The dog was friendly.", exampleAr: "رأيت كلبًا. الكلب كان ودودًا.", link: "#", quiz: { question: "متى تُستخدم 'the'؟", options: ["للمفرد غير المحدد", "للمعروف أو الفريد", "في النفي فقط"], correct: 1 } },
  { id: 15, type: "قاعدة نحوية", icon: "fa-book-open", title: "الحاضر البسيط مقابل المستمر", text: "البسيط للحقائق/العادات؛ المستمر للأحداث الجارية/المؤقتة.", example: "She works every day, but she is working from home today.", exampleAr: "إنها تعمل كل يوم، لكنها تعمل من المنزل اليوم.", link: "#", quiz: { question: "ما الذي يُعبر عنه الحاضر المستمر؟", options: ["الحقائق العامة", "الأحداث الجارية/المؤقتة", "العادات"], correct: 1 } },
  { id: 16, type: "قاعدة نحوية", icon: "fa-book-open", title: "الماضي البسيط مقابل التام الحالي", text: "الماضي البسيط لأحداث ماضية محددة؛ التام الحالي للخبرة أو الصلة بالحاضر.", example: "I visited Paris in 2019. I have visited Paris twice.", exampleAr: "زرت باريس في 2019. زرت باريس مرتين.", link: "#", quiz: { question: "ما الفرق بين الماضي البسيط والتام الحالي؟", options: ["الماضي للخبرة، التام للماضي", "الماضي لأحداث محددة، التام للخبرة", "لا فرق"], correct: 1 } },
  { id: 17, type: "قاعدة نحوية", icon: "fa-book", title: "Will مقابل Going to", text: "'Will' للوعود/القرارات اللحظية؛ 'going to' للخطط أو التوقعات مع دليل.", example: "I'll call you later. I'm going to start a course.", exampleAr: "سأتصل بك لاحقًا. سأبدأ دورة.", link: "#", quiz: { question: "متى تُستخدم 'going to'؟", options: ["للقرارات اللحظية", "للخطط أو التوقعات مع دليل", "للوعود فقط"], correct: 1 } },
  { id: 18, type: "قاعدة نحوية", icon: "fa-book", title: "المقارنة والتفضيل", text: "استخدم '-er/-est' للصفات القصيرة، 'more/most' للطويلة.", example: "This book is easier than that one. It's the most interesting.", exampleAr: "هذا الكتاب أسهل من ذلك. إنه الأكثر إثارة.", link: "#", quiz: { question: "كيف تُكوّن المقارنة للصفات القصيرة؟", options: ["بإضافة more/most", "بإضافة -er/-est", "بدون تغيير"], correct: 1 } },
  { id: 19, type: "قاعدة نحوية", icon: "fa-book-open", title: "حروف الجر للزمان: in/on/at", text: "'In' للشهور/السنوات، 'on' للأيام/التواريخ، 'at' للأوقات.", example: "The meeting is on Monday at 9 am in June.", exampleAr: "الاجتماع يوم الإثنين الساعة 9 صباحًا في يونيو.", link: "#", quiz: { question: "ما حروف الجر المستخدمة للأوقات؟", options: ["in", "on", "at"], correct: 2 } },
  { id: 20, type: "قاعدة نحوية", icon: "fa-book-open", title: "حروف الجر للمكان: in/on/at", text: "'In' للأماكن المغلقة/المدن، 'on' للأسطح، 'at' لنقاط محددة.", example: "She is at the door, on the balcony, in the kitchen.", exampleAr: "إنها عند الباب، على الشرفة، في المطبخ.", link: "#", quiz: { question: "أي حرف جر يُستخدم للأماكن المغلقة؟", options: ["at", "on", "in"], correct: 2 } },
  { id: 21, type: "قاعدة نحوية", icon: "fa-book", title: "الشرطية الصفرية والأولى", text: "الصفرية للحقائق العامة؛ الأولى للاحتمالات الواقعية.", example: "If you heat ice, it melts. If it rains, I'll stay home.", exampleAr: "إذا سخن الجليد، يذوب. إذا أمطرت، سأبقى في المنزل.", link: "#", quiz: { question: "ما الذي تعبر عنه الشرطية الصفرية؟", options: ["الاحتمالات المستقبلية", "الحقائق العامة", "الخيال"], correct: 1 } },
  { id: 22, type: "قاعدة نحوية", icon: "fa-book", title: "الشرطية الثانية", text: "تُستخدم للخيال أو الاحتمالات غير الواقعية.", example: "If I were you, I would study more.", exampleAr: "لو كنت مكانك، لدرست أكثر.", link: "#", quiz: { question: "ما الذي تُعبر عنه الشرطية الثانية؟", options: ["الحقائق", "الاحتمالات غير الواقعية", "الخطط"], correct: 1 } },
  { id: 23, type: "قاعدة نحوية", icon: "fa-book", title: "الأفعال الشرطية: should/must/have to", text: "'Should' للنصيحة؛ 'must' للضرورة؛ 'have to' للإلزام الخارجي.", example: "You should rest. I must go now. I have to work.", exampleAr: "يجب أن تستريح. يجب أن أذهب الآن. عليّ العمل.", link: "#", quiz: { question: "ما معنى 'have to'؟", options: ["نصيحة", "ضرورة", "إلزام خارجي"], correct: 2 } },
  { id: 24, type: "قاعدة نحوية", icon: "fa-book", title: "المبني للمجهول (أساسي)", text: "الصيغة: be + التصريف الثالث، تُبرز المفعول به.", example: "The letter was sent yesterday.", exampleAr: "تم إرسال الرسالة أمس.", link: "#", quiz: { question: "ما الصيغة الصحيحة للمبني للمجهول؟", options: ["be + التصريف الأول", "be + التصريف الثالث", "التصريف الثالث فقط"], correct: 1 } },
  { id: 25, type: "قاعدة نحوية", icon: "fa-book", title: "الكلام المنقول (أساسي)", text: "اضبط الأزمنة والضمائر حسب السياق عند نقل الكلام.", example: "'I am tired' → He said he was tired.", exampleAr: "أنا متعب → قال إنه كان متعبًا.", link: "#", quiz: { question: "ما الذي يتغير في الكلام المنقول؟", options: ["الأزمنة والضمائر", "الضمائر فقط", "الأزمنة فقط"], correct: 0 } },
  { id: 26, type: "قاعدة نحوية", icon: "fa-book", title: "صيغ الأسئلة: do/does/did", text: "استخدم do/does للحاضر، did للماضي في الأسئلة العامة.", example: "Do you like coffee? Did she call?", exampleAr: "هل تحب القهوة؟ هل اتصلت؟", link: "#", quiz: { question: "ما الذي يُستخدم للأسئلة في الماضي؟", options: ["do", "does", "did"], correct: 2 } },
  { id: 27, type: "قاعدة نحوية", icon: "fa-book", title: "Gerund مقابل Infinitive", text: "بعض الأفعال تتبع بـ -ing، وأخرى بـ to + verb.", example: "I enjoy reading. I hope to travel.", exampleAr: "أستمتع بالقراءة. آمل أن أسافر.", link: "#", quiz: { question: "ما الذي يتبع فعل 'enjoy'؟", options: ["to + verb", "-ing", "الفعل بدون تغيير"], correct: 1 } },
  { id: 28, type: "قاعدة نحوية", icon: "fa-book", title: "ضمائر الوصل: who/which/that", text: "'Who' للأشخاص، 'which' للأشياء، 'that' لكليهما.", example: "The man who called is my uncle.", exampleAr: "الرجل الذي اتصل هو عمي.", link: "#", quiz: { question: "ما الضمير المستخدم للأشخاص؟", options: ["which", "who", "that"], correct: 1 } },
  { id: 29, type: "قاعدة نحوية", icon: "fa-book", title: "ترتيب الصفات", text: "الرأي، الحجم، العمر، الشكل، اللون، الأصل، المادة، الاسم.", example: "A beautiful small old round brown Italian wooden table", exampleAr: "طاولة خشبية إيطالية بنية مستديرة قديمة صغيرة جميلة.", link: "#", quiz: { question: "ما الترتيب الصحيح للصفات؟", options: ["اللون، الحجم، الرأي", "الرأي، الحجم، اللون", "الحجم، الرأي، اللون"], correct: 1 } },
  { id: 30, type: "قاعدة نحوية", icon: "fa-book", title: "تطابق الفاعل والفعل", text: "يتفق الفعل مع الفاعل في العدد والشخص.", example: "The news is interesting. My friends are here.", exampleAr: "الأخبار مثيرة. أصدقائي هنا.", link: "#", quiz: { question: "ما الذي يتفق مع الفاعل؟", options: ["الفعل", "الضمير", "حرف الجر"], correct: 0 } },
  { id: 31, type: "كلمة جديدة", icon: "fa-pen", title: "Ubiquitous", text: "منتشر في كل مكان.", example: "Smartphones are ubiquitous nowadays.", exampleAr: "الهواتف الذكية منتشرة في كل مكان اليوم.", link: "#", quiz: { question: "ما معنى 'ubiquitous'؟", options: ["نادر", "منتشر في كل مكان", "غالٍ"], correct: 1 } },
  { id: 32, type: "كلمة جديدة", icon: "fa-pen", title: "Meticulous", text: "دقيق للغاية ويهتم بالتفاصيل.", example: "She is meticulous about details.", exampleAr: "إنها دقيقة جدًا بشأن التفاصيل.", link: "#", quiz: { question: "ما معنى 'meticulous'؟", options: ["دقيق للغاية", "مرن", "متسرع"], correct: 0 } },
  { id: 33, type: "كلمة جديدة", icon: "fa-pen", title: "Resilient", text: "مرن/قادر على التعافي بعد الشدائد.", example: "Children are often resilient.", exampleAr: "الأطفال غالبًا مرنون.", link: "#", quiz: { question: "ما معنى 'resilient'؟", options: ["قوي", "مرن/قادر على التعافي", "هادئ"], correct: 1 } },
  { id: 34, type: "تعبير يومي", icon: "fa-mask", title: "Once in a blue moon", text: "نادرًا جدًا.", example: "We go to the cinema once in a blue moon.", exampleAr: "نذهب إلى السينما نادرًا جدًا.", link: "#", quiz: { question: "ما معنى 'once in a blue moon'؟", options: ["دائمًا", "نادرًا جدًا", "أحيانًا"], correct: 1 } },
  { id: 35, type: "تعبير يومي", icon: "fa-mask", title: "Piece of cake", text: "سهل للغاية.", example: "The exam was a piece of cake.", exampleAr: "كان الامتحان سهلًا للغاية.", link: "#", quiz: { question: "ما معنى 'piece of cake'؟", options: ["صعب", "سهل للغاية", "ممتع"], correct: 1 } },
  { id: 36, type: "تعبير يومي", icon: "fa-mask", title: "Under the weather", text: "يشعر بتوعك أو مرض بسيط.", example: "I'm feeling under the weather today.", exampleAr: "أشعر بتوعك اليوم.", link: "#", quiz: { question: "ما معنى 'under the weather'؟", options: ["سعيد", "متعب", "يشعر بتوعك"], correct: 2 } },
  { id: 37, type: "عبارة جديدة", icon: "fa-comment", title: "Make a decision", text: "اتخاذ قرار (تراكيب متلازمة).", example: "It's time to make a decision.", exampleAr: "حان وقت اتخاذ قرار.", link: "#", quiz: { question: "ما معنى 'make a decision'؟", options: ["التفكير", "اتخاذ قرار", "التأخير"], correct: 1 } },
  { id: 38, type: "عبارة جديدة", icon: "fa-comment", title: "Take a break", text: "أخذ استراحة.", example: "Let's take a break.", exampleAr: "لنأخذ استراحة.", link: "#", quiz: { question: "ما معنى 'take a break'؟", options: ["العمل بجد", "أخذ استراحة", "الاستمرار"], correct: 1 } },
  { id: 39, type: "عبارة جديدة", icon: "fa-comment", title: "Pay attention", text: "انتبه/ركّز.", example: "Please pay attention to the instructions.", exampleAr: "من فضلك، انتبه للتعليمات.", link: "#", quiz: { question: "ما معنى 'pay attention'؟", options: ["التجاهل", "التركيز", "النسيان"], correct: 1 } },
  { id: 40, type: "عبارة جديدة", icon: "fa-comment", title: "Look up", text: "فعل مركّب يعني البحث عن معلومة في مصدر.", example: "You can look up the word online.", exampleAr: "يمكنك البحث عن الكلمة عبر الإنترنت.", link: "#", quiz: { question: "ما معنى 'look up'؟", options: ["النظر للأعلى", "البحث عن معلومة", "الابتعاد"], correct: 1 } },
  { id: 41, type: "نصيحة", icon: "fa-lightbulb", title: "التكرار المتباعد", text: "استخدم المراجعة المتباعدة لتثبيت المفردات على المدى الطويل.", example: "Review words after 1, 3, 7, 14 days.", exampleAr: "راجع الكلمات بعد 1، 3، 7، 14 يومًا.", link: "#", quiz: { question: "ما الهدف من التكرار المتباعد؟", options: ["تعلم سريع", "تثبيت المفردات طويل المدى", "تحسين النطق"], correct: 1 } },
  { id: 42, type: "نصيحة", icon: "fa-lightbulb", title: "تقنية الترديد", text: "ردّد مباشرة بعد المتحدث لتحسين النطق والإيقاع.", example: "Choose a short clip and repeat aloud.", exampleAr: "اختر مقطعًا قصيرًا وكرّره بصوت عالٍ.", link: "#", quiz: { question: "ما فائدة تقنية الترديد؟", options: ["تحسين النطق والإيقاع", "زيادة المفردات", "تحسين القراءة"], correct: 0 } },
  { id: 43, type: "نصيحة", icon: "fa-lightbulb", title: "التفكير بالإنجليزية", text: "درّب نفسك على التفكير بالإنجليزية يوميًا بجمل بسيطة.", example: "Describe what you're doing now in English.", exampleAr: "صف ما تفعله الآن بالإنجليزية.", link: "#", quiz: { question: "كيف تُطبق التفكير بالإنجليزية؟", options: ["بكتابة القصص", "بجمل بسيطة يوميًا", "بالاستماع فقط"], correct: 1 } },
  { id: 44, type: "نصيحة", icon: "fa-lightbulb", title: "الأزواج الصوتية", text: "تدرّب على أزواج الأصوات المتشابهة (ship/sheep) لتحسين السمع والنطق.", example: "Record yourself saying: ship – sheep – ship.", exampleAr: "سجّل نفسك وقل: ship – sheep – ship.", link: "#", quiz: { question: "ما فائدة الأزواج الصوتية؟", options: ["تحسين الكتابة", "تحسين السمع والنطق", "زيادة المفردات"], correct: 1 } },
  { id: 45, type: "نصيحة", icon: "fa-lightbulb", title: "الحروف الصامتة", text: "تعرّف على الحروف الصامتة: k في know، b في thumb، w في write.", example: "I know his name. My thumb hurts when I write.", exampleAr: "أعرف اسمه. إبهامي يؤلمني عندما أكتب.", link: "#", quiz: { question: "أي حرف صامت في 'know'؟", options: ["n", "k", "w"], correct: 1 } },
  { id: 46, type: "نصيحة", icon: "fa-lightbulb", title: "نطق '-ed'", text: "ثلاثة أنماط: /t/، /d/، /ɪd/ حسب الصوت الأخير.", example: "watched /t/, played /d/, wanted /ɪd/.", exampleAr: "watched /t/، played /d/، wanted /ɪd/.", link: "#", quiz: { question: "كيف يُنطق '-ed' في 'wanted'؟", options: ["/t/", "/d/", "/ɪd/"], correct: 2 } },
  { id: 47, type: "جملة مفيدة", icon: "fa-comment-dots", title: "طلب مهذب", text: "استخدم 'Could you please...?' لطلبات مهذبة.", example: "Could you please open the window?", exampleAr: "هل يمكنك من فضلك فتح النافذة؟", link: "#", quiz: { question: "ما الجملة المستخدمة لطلب مهذب؟", options: ["Open the window.", "Could you please open the window?", "I want the window open."], correct: 1 } },
  { id: 48, type: "جملة مفيدة", icon: "fa-comment-dots", title: "طلب توضيح", text: "اطلب توضيحًا عندما لا تسمع بوضوح.", example: "Sorry, could you say that again, please?", exampleAr: "آسف، هل يمكنك قول ذلك مرة أخرى من فضلك؟", link: "#", quiz: { question: "ما الجملة لطلب توضيح؟", options: ["What?", "Sorry, could you say that again, please?", "Speak louder."], correct: 1 } },
  { id: 49, type: "جملة مفيدة", icon: "fa-comment-dots", title: "السؤال عن المعنى", text: "استخدم 'What does ... mean?' للسؤال عن المعنى.", example: "What does 'meticulous' mean?", exampleAr: "ماذا تعني 'meticulous'؟", link: "#", quiz: { question: "كيف تسأل عن معنى كلمة؟", options: ["What is this?", "What does ... mean?", "Why is this?"], correct: 1 } },
  { id: 50, type: "جملة مفيدة", icon: "fa-comment-dots", title: "اعتذار رسمي", text: "اعتذار رسمي مختصر.", example: "Sorry for the inconvenience caused.", exampleAr: "آسف على الإزعاج الذي تسببت فيه.", link: "#", quiz: { question: "ما مثال على اعتذار رسمي؟", options: ["Sorry, my bad.", "Sorry for the inconvenience caused.", "Oops, sorry."], correct: 1 } },
  { id: 51, type: "جملة مفيدة", icon: "fa-praying-hands", title: "طلب مهذب", text: "طلب مهذب باستخدام 'Would you mind...'.", example: "Would you mind sending me the file?", exampleAr: "هل تمانع في إرسال الملف لي؟", link: "#", quiz: { question: "ما الجملة التي تستخدم 'Would you mind'؟", options: ["Send me the file.", "Would you mind sending me the file?", "Can you send the file?"], correct: 1 } },
  { id: 52, type: "صيغة بريد", icon: "fa-envelope", title: "متابعة بريد", text: "عبارة متابعة لطيفة لتذكير بدون إلحاح.", example: "Just following up on my previous email.", exampleAr: "أتابع فقط بشأن بريدي السابق.", link: "#", quiz: { question: "ما عبارة متابعة بريد لطيفة؟", options: ["Where’s my reply?", "Just following up on my previous email.", "Please respond."], correct: 1 } },
  { id: 53, type: "جملة مفيدة", icon: "fa-question", title: "توضيح", text: "طلب توضيح بلباقة.", example: "Could you clarify what you mean by ‘X’?", exampleAr: "هل يمكنك توضيح ماذا تعني بـ'X'؟", link: "#", quiz: { question: "كيف تطلب توضيحًا بلباقة؟", options: ["What’s that?", "Could you clarify what you mean by ‘X’?", "Explain it."], correct: 1 } },
  { id: 54, type: "جملة مفيدة", icon: "fa-calendar", title: "جدولة", text: "اقتراح موعد بمرونة.", example: "Does Thursday at 3 PM work for you?", exampleAr: "هل يناسبك الخميس الساعة 3 عصرًا؟", link: "#", quiz: { question: "ما اقتراح موعد مرن؟", options: ["Meet me Thursday.", "Does Thursday at 3 PM work for you?", "Come at 3 PM."], correct: 1 } },
  { id: 55, type: "تعبير", icon: "fa-heart", title: "التقدير", text: "التعبير عن التقدير بشكل صادق.", example: "I appreciate your help.", exampleAr: "أقدر مساعدتك.", link: "#", quiz: { question: "كيف تعبر عن التقدير؟", options: ["Thanks a lot.", "I appreciate your help.", "Good job."], correct: 1 } },
  { id: 56, type: "تعبير", icon: "fa-balance-scale", title: "تلطيف الاختلاف", text: "تلطيف الاختلاف قبل عرض وجهة نظرك.", example: "I see your point; however, I have a different view.", exampleAr: "أرى وجهة نظرك؛ لكن لدي رأي مختلف.", link: "#", quiz: { question: "كيف تلطف الاختلاف؟", options: ["You’re wrong.", "I see your point; however, I have a different view.", "I don’t agree."], correct: 1 } },
  { id: 57, type: "مهني", icon: "fa-check-circle", title: "الخطوات التالية", text: "تلخيص عناصر العمل في نهاية النقاش.", example: "Next steps: 1) Review, 2) Update, 3) Share by Friday.", exampleAr: "الخطوات التالية: 1) مراجعة، 2) تحديث، 3) مشاركة بحلول الجمعة.", link: "#", quiz: { question: "ما معنى 'next steps'؟", options: ["الخطط المستقبلية", "تلخيص عناصر العمل", "إنهاء النقاش"], correct: 1 } },
  { id: 58, type: "فعل مركب", icon: "fa-puzzle-piece", title: "Carry out", text: "ينفّذ/يُجري — غالبًا لمهام رسمية.", example: "We will carry out a user survey.", exampleAr: "سننفذ استطلاعًا للمستخدمين.", link: "#", quiz: { question: "ما معنى 'carry out'؟", options: ["التوقف", "التنفيذ/الإجراء", "البحث"], correct: 1 } },
  { id: 59, type: "فعل مركب", icon: "fa-search", title: "Look into", text: "يتحقق/يبحث — لمتابعة مسألة.", example: "I’ll look into the issue and get back to you.", exampleAr: "سأتحقق من المشكلة وأعود إليك.", link: "#", quiz: { question: "ما معنى 'look into'؟", options: ["النظر للأعلى", "التحقق/البحث", "التجاهل"], correct: 1 } },
  { id: 60, type: "تركيب شائع", icon: "fa-clock", title: "Meet a deadline", text: "تركيب شائع يعني الالتزام بالموعد النهائي.", example: "We must meet the deadline.", exampleAr: "يجب أن نلتزم بالموعد النهائي.", link: "#", quiz: { question: "ما معنى 'meet a deadline'؟", options: ["تأخير الموعد", "الالتزام بالموعد", "إلغاء الموعد"], correct: 1 } },
  { id: 61, type: "تركيب شائع", icon: "fa-brain", title: "Make a decision", text: "تركيب شائع لاتخاذ قرار.", example: "It’s time to make a decision.", exampleAr: "حان وقت اتخاذ قرار.", link: "#", quiz: { question: "ما معنى 'make a decision'؟", options: ["التفكير", "اتخاذ قرار", "التأخير"], correct: 1 } },
  { id: 62, type: "تعبير اصطلاحي", icon: "fa-thumbs-up", title: "Rule of thumb", text: "قاعدة عامة غير رسمية.", example: "As a rule of thumb, keep emails under 200 words.", exampleAr: "كقاعدة عامة، حافظ على رسائل البريد أقل من 200 كلمة.", link: "#", quiz: { question: "ما معنى 'rule of thumb'؟", options: ["قانون صارم", "قاعدة عامة غير رسمية", "تعليمات رسمية"], correct: 1 } },
  { id: 63, type: "أدوات ربط", icon: "fa-plus", title: "In addition", text: "أداة ربط لإضافة معلومة.", example: "In addition, we should consider the budget.", exampleAr: "بالإضافة إلى ذلك، يجب أن نأخذ الميزانية في الاعتبار.", link: "#", quiz: { question: "ما وظيفة 'in addition'؟", options: ["النفي", "إضافة معلومة", "التناقض"], correct: 1 } },
  { id: 64, type: "صيغة رسمية", icon: "fa-envelope-open", title: "اختتام رسمي", text: "اختتام رسمي للبريد.", example: "Kind regards,", exampleAr: "مع أطيب التحيات،", link: "#", quiz: { question: "ما مثال على اختتام رسمي؟", options: ["Cheers,", "Kind regards,", "See you,"], correct: 1 } },
  { id: 65, type: "صيغة غير رسمية", icon: "fa-smile", title: "اختتام غير رسمي", text: "اختتام غير رسمي وودود.", example: "Cheers,", exampleAr: "تحيات،", link: "#", quiz: { question: "ما مثال على اختتام غير رسمي؟", options: ["Kind regards,", "Cheers,", "Sincerely,"], correct: 1 } },
  { id: 66, type: "نطق", icon: "fa-volume-up", title: "نهايات -ed", text: "نطق نهايات -ed: /t/، /d/، /ɪd/.", example: "worked (t), played (d), wanted (ɪd).", exampleAr: "worked /t/، played /d/، wanted /ɪd/.", link: "#", quiz: { question: "كيف يُنطق '-ed' في 'played'؟", options: ["/t/", "/d/", "/ɪd/"], correct: 1 } },
  { id: 67, type: "اجتماعات", icon: "fa-user-tie", title: "بدء الاجتماع", text: "بدء الاجتماع بسلاسة.", example: "Shall we begin?", exampleAr: "هل نبدأ؟", link: "#", quiz: { question: "كيف تبدأ اجتماعًا بسلاسة؟", options: ["Let’s go.", "Shall we begin?", "Start now."], correct: 1 } },
  { id: 68, type: "عروض", icon: "fa-microphone", title: "افتتاح عرض تقديمي", text: "افتتاح عرض تقديمي بثقة.", example: "Let’s get started.", exampleAr: "لنبدأ.", link: "#", quiz: { question: "ما افتتاح عرض تقديمي بثقة؟", options: ["Here we go.", "Let’s get started.", "Okay, now."], correct: 1 } },
  { id: 69, type: "تفاوض", icon: "fa-handshake", title: "منفتح على الخيارات", text: "اقتراح مرن أثناء التفاوض.", example: "Would you be open to a 10% discount for volume?", exampleAr: "هل تكون منفتحًا على خصم 10% للكميات؟", link: "#", quiz: { question: "كيف تقترح خيارًا مرنًا في التفاوض؟", options: ["Give me a discount.", "Would you be open to a 10% discount for volume?", "I want a discount."], correct: 1 } },
  { id: 70, type: "اعتذار", icon: "fa-hourglass", title: "رد متأخر", text: "اعتذار مهذب عن التأخير.", example: "Sorry for the late reply.", exampleAr: "آسف على الرد المتأخر.", link: "#", quiz: { question: "ما اعتذار مهذب عن التأخير؟", options: ["Sorry for the late reply.", "I forgot to reply.", "Why didn’t you reply?"], correct: 0 } }
];

const moreTips = [
{ id: 71, type: "قاعدة نحوية", icon: "fa-book", title: "Many / Much / A lot of", text: "many لِلمعدود الجمع؛ much لغير المعدود؛ a lot of تصلح لكليهما (خاصة في الجمل الإيجابية).", example: "We have many books. We don't have much milk. We have a lot of time.", exampleAr: "لدينا كثير من الكتب. ليس لدينا الكثير من الحليب. لدينا الكثير من الوقت.", link: "#", quiz: { question: "متى نستخدم many؟", options: ["مع الأسماء غير المعدودة", "مع الأسماء المعدودة الجمع", "في الجمل السلبية فقط"], correct: 1 } },
{ id: 72, type: "قاعدة نحوية", icon: "fa-book", title: "Some مقابل Any", text: "some غالبًا في الإثبات والعروض/الطلبات؛ any في النفي والأسئلة.", example: "I have some apples. Do you have any sugar? Would you like some tea?", exampleAr: "لدي بعض التفاح. هل لديك أي سكر؟ هل تود بعض الشاي؟", link: "#", quiz: { question: "أين نستخدم any عادة؟", options: ["في الإثبات", "في النفي والأسئلة", "فقط في العروض"], correct: 1 } },
{ id: 73, type: "قاعدة نحوية", icon: "fa-book", title: "A lot of / Lots of / Plenty of", text: "a lot of=محايد؛ lots of=غير رسمي؛ plenty of=قدر كافٍ وزيادة.", example: "We have lots of ideas. There is plenty of room.", exampleAr: "لدينا الكثير من الأفكار. هناك متسع كافٍ وزيادة.", link: "#", quiz: { question: "أيها يعني «أكثر من الكافي»؟", options: ["a lot of", "lots of", "plenty of"], correct: 2 } },
{ id: 74, type: "قاعدة نحوية", icon: "fa-book-open", title: "Since مقابل For", text: "for لمدة زمنية؛ since لنقطة بداية محددة.", example: "I have lived here for 5 years. I have lived here since 2019.", exampleAr: "أعيش هنا منذ 5 سنوات. أعيش هنا منذ 2019.", link: "#", quiz: { question: "أيها يُستخدم مع نقطة زمنية؟", options: ["since", "for"], correct: 0 } },
{ id: 75, type: "قاعدة نحوية", icon: "fa-book-open", title: "Used to / Be used to / Get used to", text: "used to + فعل للماضي المُنتهي؛ be/get used to + اسم/ing للعادة أو الاعتياد.", example: "I used to smoke. I'm used to waking up early. I'm getting used to my new job.", exampleAr: "كنت أدخن (ولم أعد). أنا معتاد على الاستيقاظ مبكرًا. أنا أعتاد على عملي الجديد.", link: "#", quiz: { question: "أي صيغة تعني «عادة قديمة توقفت»؟", options: ["be used to", "used to", "get used to"], correct: 1 } },
{ id: 76, type: "قاعدة نحوية", icon: "fa-book", title: "So مقابل Such", text: "so + صفة/حال؛ such + (a/an) + صفة + اسم.", example: "It’s so cold. It’s such a cold day.", exampleAr: "إنه بارد جدًا. إنه يوم بارد جدًا.", link: "#", quiz: { question: "أكمل: It’s ___ beautiful day.", options: ["so", "such a"], correct: 1 } },
{ id: 77, type: "قاعدة نحوية", icon: "fa-book", title: "Too مقابل Enough", text: "too = أكثر من اللازم؛ enough = قدر كافٍ. before noun: enough time، بعد الصفة: warm enough.", example: "It’s too late to call. I don’t have enough money. The soup isn’t hot enough.", exampleAr: "إنه متأخر جدًا للاتصال. لا أملك مالًا كافيًا. الحساء ليس حارًا بما يكفي.", link: "#", quiz: { question: "أين نضع enough مع الاسم؟", options: ["بعد الاسم", "قبل الاسم", "لا فرق"], correct: 1 } },
{ id: 78, type: "قاعدة نحوية", icon: "fa-book", title: "Already / Yet / Just", text: "already في الإثبات؛ yet في النفي/الأسئلة؛ just لشيء حدث للتو.", example: "I’ve already eaten. Have you finished yet? I’ve just arrived.", exampleAr: "لقد أكلت بالفعل. هل انتهيت بعد؟ لقد وصلت للتو.", link: "#", quiz: { question: "أي كلمة نستخدمها في سؤال لمعرفة إن كان الشيء حدث حتى الآن؟", options: ["already", "yet", "just"], correct: 1 } },
{ id: 79, type: "قاعدة نحوية", icon: "fa-book", title: "Question Tags", text: "سؤال قصير في نهاية الجملة للتأكد: جملة مثبتة + نفي، والعكس.", example: "You’re coming, aren’t you? She can swim, can’t she?", exampleAr: "أنت قادم، أليس كذلك؟ إنها تستطيع السباحة، أليس كذلك؟", link: "#", quiz: { question: "أكمل: You don’t mind, ___?", options: ["do you?", "don’t you?", "are you?"], correct: 0 } },
{ id: 80, type: "قاعدة نحوية", icon: "fa-book-open", title: "Defining vs Non-defining Relative Clauses", text: "التعريفية بلا فواصل؛ غير التعريفية بين فواصل، ولا نستخدم that فيها.", example: "The car that I bought is fast. My car, which I bought in 2020, is fast.", exampleAr: "السيارة التي اشتريتها سريعة. سيارتي، التي اشتريتها في 2020، سريعة.", link: "#", quiz: { question: "هل نضع فواصل في الجملة غير التعريفية؟", options: ["نعم", "لا"], correct: 0 } },
{ id: 81, type: "قاعدة نحوية", icon: "fa-book-open", title: "Zero Article (بدون أداة)", text: "لا نستخدم أداة مع: وجبات (breakfast)، لغات (English)، رياضات (football)، ومع go to: school/work/bed/hospital.", example: "We had lunch at school. She plays football and speaks English.", exampleAr: "تناولنا الغداء في المدرسة. هي تلعب كرة القدم وتتحدث الإنجليزية.", link: "#", quiz: { question: "أيها صحيح؟", options: ["I have the lunch.", "I have lunch.", "I have a lunch."], correct: 1 } },
{ id: 82, type: "قاعدة نحوية", icon: "fa-book", title: "Either / Neither / Both", text: "either...or = واحد من اثنين؛ neither...nor = لا هذا ولا ذاك؛ both = الاثنان معًا.", example: "Either coffee or tea is fine. Neither Tom nor Sam was there. Both answers are correct.", exampleAr: "إما القهوة أو الشاي مناسب. لا توم ولا سام كان هناك. الإجابتان صحيحتان.", link: "#", quiz: { question: "___ of the answers is correct (ولا واحدة).", options: ["Either", "Neither", "Both"], correct: 1 } },
{ id: 83, type: "قاعدة نحوية", icon: "fa-book", title: "By مقابل Until", text: "by للموعد النهائي؛ until لمدة الاستمرار حتى لحظة.", example: "Finish the report by Friday. I worked until midnight.", exampleAr: "أنهِ التقرير بحلول الجمعة. عملت حتى منتصف الليل.", link: "#", quiz: { question: "We must finish ___ 5 pm.", options: ["until", "by"], correct: 1 } },
{ id: 84, type: "قاعدة نحوية", icon: "fa-book", title: "Make مقابل Do", text: "do للأعمال/الأنشطة العامة؛ make للإنشاء/النتيجة.", example: "do homework, do the dishes; make a decision, make a mistake.", exampleAr: "يقوم بالواجب/يغسل الصحون؛ يتخذ قرارًا/يرتكب خطأً.", link: "#", quiz: { question: "اختر الصحيح: ___ your bed.", options: ["Do", "Make"], correct: 1 } },
{ id: 85, type: "قاعدة نحوية", icon: "fa-book", title: "Say مقابل Tell", text: "say + شيء؛ tell + شخص (+ شيء).", example: "He said that he was tired. He told me the truth.", exampleAr: "قال إنه كان متعبًا. قال لي الحقيقة.", link: "#", quiz: { question: "الصحيح: He ___ me the truth.", options: ["said", "told"], correct: 1 } },
{ id: 86, type: "قاعدة نحوية", icon: "fa-book", title: "Each مقابل Every", text: "every + مفرد للجماعة ككل؛ each للتأكيد على كل فرد؛ each of + جمع.", example: "Every student has a book. Each of the students has a book.", exampleAr: "كل طالب لديه كتاب. كل واحد من الطلاب لديه كتاب.", link: "#", quiz: { question: "اختر الصحيح: ___ student has a book.", options: ["Each", "Every"], correct: 1 } },
{ id: 87, type: "قاعدة نحوية", icon: "fa-book", title: "Still / Yet / Anymore", text: "still لما يستمر؛ yet للنفي/الأسئلة؛ anymore للنفي بمعنى «لم يعد».", example: "I’m still here. I haven’t finished yet. I don’t live there anymore.", exampleAr: "أنا ما زلت هنا. لم أنتهِ بعد. لم أعد أعيش هناك.", link: "#", quiz: { question: "أكمل: I don’t live there ___.", options: ["still", "yet", "anymore"], correct: 2 } },
{ id: 88, type: "قاعدة نحوية", icon: "fa-book-open", title: "Gerund/Infinitive: stop/try/remember", text: "stop doing=يتوقف عن؛ stop to do=يتوقف ليقوم بـ؛ try to do=محاولة؛ try doing=تجربة؛ remember to do=لا تنسَ؛ remember doing=تذكر حدثًا.", example: "I stopped smoking. I stopped to buy water. I tried to call. Try restarting the app. Remember to lock the door. I remember meeting her.", exampleAr: "توقفت عن التدخين. توقفت لأشتري ماءً. حاولت الاتصال. جرّب إعادة تشغيل التطبيق. لا تنسَ إغلاق الباب. أتذكر أنني قابلتها.", link: "#", quiz: { question: "الصحيح: I stopped ___ coffee.", options: ["to drink", "drinking"], correct: 1 } },
{ id: 89, type: "قاعدة نحوية", icon: "fa-book-open", title: "الشرطية الثالثة (خيال الماضي)", text: "If + past perfect, would have + V3 لنتائج ماضية لم تحدث.", example: "If I had known, I would have called. If she had left earlier, she would have caught the bus.", exampleAr: "لو كنتُ أعلم لاتصلت. لو غادرت مبكرًا لَأدركت الحافلة.", link: "#", quiz: { question: "أكمل: If he ___ (know), he ___ (help).", options: ["knew / would help", "had known / would have helped", "knows / will help"], correct: 1 } },
{ id: 90, type: "قاعدة نحوية", icon: "fa-book-open", title: "Wish / If only", text: "wish + past للحاضر: أتمنى لو...؛ wish + had + V3 للماضي؛ wish + would لشكوى من عادة شخص آخر.", example: "I wish I had more time. I wish I had studied. I wish you would stop smoking.", exampleAr: "أتمنى لو كان لدي وقت أكثر. أتمنى لو كنت قد درست. أتمنى لو تتوقف عن التدخين.", link: "#", quiz: { question: "الأفضل لندم حاضر: I wish I ___ more time.", options: ["have", "had", "would have"], correct: 1 } },
{ id: 91, type: "قاعدة نحوية", icon: "fa-book", title: "أدوات + الوظائف والجنسيات", text: "نستخدم a/an قبل الوظائف والجنسيات بصيغة الاسم: a teacher, an engineer, an Egyptian.", example: "She is a doctor. He is an Italian.", exampleAr: "هي طبيبة. هو إيطالي.", link: "#", quiz: { question: "الصحيح: She is ___ engineer.", options: ["engineer", "an engineer", "a engineer"], correct: 1 } },
{ id: 92, type: "تعبير شائع", icon: "fa-plus", title: "A couple of / Quite a few / A bit of", text: "a couple of=اثنان تقريبًا؛ quite a few=عدد لا بأس به؛ a bit of=قليل من (غير معدود).", example: "I’ll need a couple of days. We got quite a few emails. I need a bit of help.", exampleAr: "سأحتاج يومين تقريبًا. وصلتنا رسائل عديدة نوعًا ما. أحتاج قليلًا من المساعدة.", link: "#", quiz: { question: "أيها يُستخدم مع غير المعدود؟", options: ["a couple of", "quite a few", "a bit of"], correct: 2 } },
{ id: 93, type: "قاعدة نحوية", icon: "fa-book-open", title: "Present Perfect vs Present Perfect Continuous", text: "التام البسيط للنتيجة/عدد المرات؛ المستمر للمدة/النشاط المستمر.", example: "I have read three chapters. I have been reading for two hours.", exampleAr: "قرأت ثلاثة فصول. أنا أقرأ منذ ساعتين.", link: "#", quiz: { question: "أي زمن يبرز المدة؟", options: ["Present Perfect", "Present Perfect Continuous"], correct: 1 } },
{ id: 94, type: "قاعدة نحوية", icon: "fa-book", title: "الأفعال المركبة: قابلة/غير قابلة للفصل", text: "turn off قابل للفصل: turn the light off / turn it off؛ look after غير قابل للفصل.", example: "Turn the TV off. Look after your sister.", exampleAr: "أطفئ التلفاز. اعتنِ بأختك.", link: "#", quiz: { question: "أي فعل يمكن فصله مع ضمير؟", options: ["turn off", "look after"], correct: 0 } },
{ id: 95, type: "تركيب شائع", icon: "fa-plus", title: "Adjective + Preposition", text: "تركيبات ثابتة: good at, interested in, afraid of, responsible for.", example: "She is good at math. I’m interested in AI.", exampleAr: "هي جيدة في الرياضيات. أنا مهتم بالذكاء الاصطناعي.", link: "#", quiz: { question: "الصحيح: He is ___ physics.", options: ["good in", "good at", "good on"], correct: 1 } },
{ id: 96, type: "تركيب شائع", icon: "fa-plus", title: "Verb + Preposition", text: "depend on, listen to, wait for, apologize for.", example: "It depends on the price. We’re waiting for the bus.", exampleAr: "يعتمد على السعر. نحن ننتظر الحافلة.", link: "#", quiz: { question: "الصحيح: Listen ___ your teacher.", options: ["to", "for", "at"], correct: 0 } },
{ id: 97, type: "أدوات ربط", icon: "fa-plus", title: "However / Therefore / Moreover", text: "however=تباين؛ therefore=نتيجة؛ moreover=إضافة.", example: "It was late; however, we continued. Sales dropped; therefore, we cut costs.", exampleAr: "كان الوقت متأخرًا؛ ومع ذلك واصلنا. انخفضت المبيعات؛ لذلك خفّضنا التكاليف.", link: "#", quiz: { question: "أي أداة تُظهر نتيجة؟", options: ["however", "therefore", "moreover"], correct: 1 } },
{ id: 98, type: "قاعدة نحوية", icon: "fa-book", title: "الكلام المنقول: الأسئلة", text: "لأسئلة نعم/لا: ask + if/whether؛ لأسئلة wh: نحافظ على أداة السؤال ونرتب كجملة خبرية.", example: "“Do you like it?” → He asked if I liked it. “Where is he?” → He asked where he was.", exampleAr: "«هل يعجبك؟» → سأل إن كنتُ أحبه. «أين هو؟» → سأل أين كان.", link: "#", quiz: { question: "اختر أداة مناسبة لأسئلة نعم/لا:", options: ["if", "who", "what"], correct: 0 } },
{ id: 99, type: "قاعدة نحوية", icon: "fa-book-open", title: "Past Simple vs Past Continuous", text: "الماضي المستمر للفعل الطويل/الخلفية؛ الماضي البسيط لحدث قصير قاطع. while + مستمر، when + بسيط غالبًا.", example: "I was cooking when he arrived. While I was walking, it started to rain.", exampleAr: "كنت أطبخ عندما وصل. بينما كنت أمشي، بدأ المطر.", link: "#", quiz: { question: "أيها أنسب مع while؟", options: ["Past Simple", "Past Continuous"], correct: 1 } },
{ id: 100, type: "قاعدة نحوية", icon: "fa-book", title: "As ... as / Not as ... as", text: "as + صفة + as للمساواة؛ not as/so ... as للنفي.", example: "He is as tall as his brother. This test isn’t as hard as the last one.", exampleAr: "هو بطول أخيه. هذا الاختبار ليس صعبًا مثل السابق.", link: "#", quiz: { question: "أكمل: She is not ___ tall ___ her sister.", options: ["as / as", "so / like", "as / like"], correct: 0 } },
{ id: 101, type: "كلمة جديدة", icon: "fa-pen", title: "Compelling", text: "مقنع/جذاب بشدة لدرجة يُصعب تجاهله.", example: "She gave a compelling argument. The story is compelling.", exampleAr: "قدمت حجة مقنعة. القصة جذابة جدًا.", link: "#", quiz: { question: "ما معنى 'compelling'؟", options: ["ممل", "مقنع/جذاب", "معقّد"], correct: 1 } },
{ id: 102, type: "كلمة جديدة", icon: "fa-pen", title: "Feasible", text: "قابل للتنفيذ عمليًا.", example: "Is this plan feasible? A feasible solution.", exampleAr: "هل هذه الخطة قابلة للتنفيذ؟ حل قابل للتنفيذ.", link: "#", quiz: { question: "اختر المعنى الأقرب لـ 'feasible':", options: ["خيالي", "قابل للتنفيذ", "باهظ"], correct: 1 } },
{ id: 103, type: "كلمة جديدة", icon: "fa-pen", title: "Ambiguous", text: "غامض/ملتبس وله أكثر من معنى.", example: "The question is ambiguous. Avoid ambiguous terms.", exampleAr: "السؤال ملتبس. تجنب المصطلحات الغامضة.", link: "#", quiz: { question: "'Ambiguous' تعني:", options: ["واضح جدًا", "غامض/ملتبس", "مستحيل"], correct: 1 } },
{ id: 104, type: "تعبير يومي", icon: "fa-mask", title: "Hit the nail on the head", text: "أصاب كبد الحقيقة/حدّد المشكلة بدقة.", example: "You hit the nail on the head with that comment.", exampleAr: "أصبت كبد الحقيقة بذلك التعليق.", link: "#", quiz: { question: "ما معنى التعبير؟", options: ["أخطأ كثيرًا", "أصاب الهدف بدقة", "تأخر جدًا"], correct: 1 } },
{ id: 105, type: "تعبير يومي", icon: "fa-mask", title: "Break the ice", text: "كسر الجمود وبدء الحديث براحة.", example: "A joke can break the ice at meetings.", exampleAr: "نكتة يمكن أن تكسر الجمود في الاجتماعات.", link: "#", quiz: { question: "متى تستخدم 'break the ice'؟", options: ["عند بدء حديث وجعل الجو مريحًا", "عند إنهاء علاقة", "عند طلب مساعدة"], correct: 0 } },
{ id: 106, type: "فعل مركب", icon: "fa-puzzle-piece", title: "Figure out", text: "يكتشف/يفهم حلًا بعد تفكير.", example: "I can’t figure out this problem. We figured out a way to save time.", exampleAr: "لا أستطيع فهم هذه المسألة. وجدنا طريقة لتوفير الوقت.", link: "#", quiz: { question: "'figure out' تعني:", options: ["يتجاهل", "يفهم/يكتشف", "يؤجل"], correct: 1 } },
{ id: 107, type: "فعل مركب", icon: "fa-puzzle-piece", title: "Set up", text: "يؤسّس/يُعدّ/يرتب.", example: "We set up a new account. They set up the projector.", exampleAr: "أنشأنا حسابًا جديدًا. قاموا بإعداد جهاز العرض.", link: "#", quiz: { question: "ما معنى 'set up'؟", options: ["يلغي", "يؤسّس/يُعدّ", "يبيع"], correct: 1 } },
{ id: 108, type: "فعل مركب", icon: "fa-puzzle-piece", title: "Pick up", text: "يلتقط/يتحسّن/يأخذ بالسيارة.", example: "I’ll pick you up at 7. Sales are picking up.", exampleAr: "سأوصلك بالسيارة الساعة 7. المبيعات تتحسن.", link: "#", quiz: { question: "'pick up' قد تعني:", options: ["يتدهور", "يلتقط/يقلّ شخصًا/يتحسّن", "ينام"], correct: 1 } },
{ id: 109, type: "نطق", icon: "fa-volume-up", title: "صوت الشِّوا /ə/", text: "أكثر صوت انتشارًا في الإنجليزية: vowel مخفف في مقاطع غير مشددة.", example: "about /əˈbaʊt/, teacher /ˈtiːtʃər/ (er = /ər/).", exampleAr: "about /əˈbaʊt/، teacher /ˈtiːtʃər/ (er ≈ /ər/).", link: "#", quiz: { question: "أين يظهر /ə/ غالبًا؟", options: ["في المقاطع المشددة", "في المقاطع غير المشددة", "لا يستخدم"], correct: 1 } },
{ id: 110, type: "نطق", icon: "fa-volume-up", title: "ثـ: /θ/ وذ: /ð/", text: "ضع اللسان بين الأسنان: /θ/ كما في think، /ð/ كما في this.", example: "think /θɪŋk/, this /ðɪs/.", exampleAr: "think /θɪŋk/، this /ðɪs/.", link: "#", quiz: { question: "أي كلمة فيها /ð؟", options: ["thank", "this", "thick"], correct: 1 } }
];
const el = id => document.getElementById(id);
const manualIndexKey = 'tip_manual_index';
const todayKey = 'tipOfDay_date';
const streakKey = 'tip_streak';
const langKey = 'tip_lang';

let currentLang = localStorage.getItem(langKey) || 'ar';
let currentTipIndex = 0;

function formatDate(dateISO, lang) {
  try {
    const d = new Date(dateISO);
    return d.toLocaleString(lang === 'ar' ? 'ar-EG' : 'en-US', { dateStyle: 'medium', timeStyle: 'short' });
  } catch (e) {
    return new Date(dateISO).toLocaleString();
  }
}

function updateStats(id) {
  const key = `tip_stats_${id}`;
  const now = new Date().toISOString();
  let stats = JSON.parse(localStorage.getItem(key) || '{}');
  stats.openCount = (stats.openCount || 0) + 1;
  stats.lastOpened = now;
  stats.history = stats.history || [];
  stats.history.unshift(now);
  if (stats.history.length > 5) stats.history.length = 5;
  localStorage.setItem(key, JSON.stringify(stats));
  return stats;
}

function updateStreak() {
  const now = new Date();
  const last = localStorage.getItem(streakKey);
  const lastDate = last ? new Date(last) : null;
  const isSameDay = lastDate && lastDate.toDateString() === now.toDateString();
  let streak = Number(localStorage.getItem(streakKey + '_count') || 0);
  if (!isSameDay) {
    if (lastDate && now - lastDate > 86400000) streak = 0;
    streak++;
    localStorage.setItem(streakKey, now.toISOString());
    localStorage.setItem(streakKey + '_count', streak);
  }
  return streak;
}

function showTip(index) {
  const tip = tips[index];
  currentTipIndex = index;
  el('tip-icon').className = `icon fas ${tip.icon || 'fa-book'}`;
  el('tip-type').textContent = tip.type + (tip.title ? ` — ${tip.title}` : '');
  el('tip-text').textContent = currentLang === 'ar' ? tip.text : tip.text;
  el('tip-example').textContent = currentLang === 'ar' ? (tip.exampleAr || tip.example) : tip.example;
  el('tip-example').style.display = tip.example ? 'block' : 'none';

  if (tip.link && tip.link !== '#') {
    el('more').style.display = 'inline';
    el('more').onclick = () => { window.location.href = tip.link; trackEvent('more', tip.id); };
  } else {
    el('more').style.display = 'none';
  }

  el('quiz-section').style.display = 'none';
  el('quiz-btn').textContent = currentLang === 'ar' ? 'اختبار' : 'Quiz';
  updateStats(tip.id);
  updateStreak();
  localStorage.setItem(manualIndexKey, index);
  trackEvent('view', tip.id);
}

function showQuiz(index) {
  const tip = tips[index];
  if (!tip.quiz) return;

  el('quiz-section').style.display = 'block';
  el('quiz-question').textContent = currentLang === 'ar' ? tip.quiz.question : tip.quiz.question;
  el('quiz-options').innerHTML = '';
  el('quiz-feedback').style.display = 'none';

  tip.quiz.options.forEach((option, i) => {
    const optionEl = document.createElement('div');
    optionEl.className = 'quiz-option';
    optionEl.textContent = currentLang === 'ar' ? option : option;
    optionEl.addEventListener('click', () => handleQuizAnswer(index, i));
    el('quiz-options').appendChild(optionEl);
  });

  el('quiz-btn').textContent = currentLang === 'ar' ? 'إخفاء الاختبار' : 'Hide Quiz';
}

function handleQuizAnswer(tipIndex, selectedOption) {
  const tip = tips[tipIndex];
  const options = el('quiz-options').children;
  const feedbackEl = el('quiz-feedback');

  for (let i = 0; i < options.length; i++) {
    options[i].classList.remove('correct', 'incorrect');
    options[i].style.pointerEvents = 'none';
    if (i === tip.quiz.correct) {
      options[i].classList.add('correct');
    } else if (i === selectedOption) {
      options[i].classList.add('incorrect');
    }
  }

  feedbackEl.textContent = selectedOption === tip.quiz.correct
    ? (currentLang === 'ar' ? 'إجابة صحيحة!' : 'Correct!')
    : (currentLang === 'ar' ? 'إجابة خاطئة، حاول مرة أخرى!' : 'Incorrect, try again!');
  feedbackEl.style.display = 'block';
  trackEvent('quiz_answer', tip.id, { correct: selectedOption === tip.quiz.correct });
}

function trackEvent(action, id, extra = {}) {
  console.log('Event:', { action, id, ...extra });
}

function getIndexForDay() {
  const now = new Date();
  const start = new Date(now.getFullYear(), 0, 0);
  const diff = now - start;
  const oneDay = 1000 * 60 * 60 * 24;
  const dayOfYear = Math.floor(diff / oneDay);
  return dayOfYear % tips.length;
}

function initTip() {
  const storedDate = localStorage.getItem(todayKey);
  const nowDate = new Date().toDateString();
  let index;
  if (storedDate === nowDate && localStorage.getItem(manualIndexKey) !== null) {
    index = Number(localStorage.getItem(manualIndexKey));
  } else {
    index = getIndexForDay();
    localStorage.setItem(todayKey, nowDate);
    localStorage.setItem(manualIndexKey, index);
  }
  showTip(index);
}

el('prev').addEventListener('click', () => {
  const cur = Number(localStorage.getItem(manualIndexKey) || 0);
  const next = (cur - 1 + tips.length) % tips.length;
  showTip(next);
});

el('next').addEventListener('click', () => {
  const cur = Number(localStorage.getItem(manualIndexKey) || 0);
  const next = (cur + 1) % tips.length;
  showTip(next);
});

el('quiz-btn').addEventListener('click', () => {
  if (el('quiz-section').style.display === 'block') {
    el('quiz-section').style.display = 'none';
    el('quiz-btn').textContent = currentLang === 'ar' ? 'اختبار' : 'Quiz';
  } else {
    showQuiz(currentTipIndex);
  }
});

el('langSwitch').addEventListener('click', () => {
  currentLang = currentLang === 'ar' ? 'en' : 'ar';
  localStorage.setItem(langKey, currentLang);
  location.reload();
});

initTip();